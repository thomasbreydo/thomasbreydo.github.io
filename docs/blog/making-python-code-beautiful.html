<!doctype html>

<html class="no-js" lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <!-- Page Info -->
    <link rel="shortcut icon" href="/favicon.ico">
    <title>Making Python code beautiful – Thomas Breydo</title>
    <meta name="description"
          content="A bit of Python code can be written so well that your boss and coworkers will marvel at its beauty.">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title"
          content="Making Python code beautiful – Thomas Breydo">
    <meta name="twitter:description"
          content="A bit of Python code can be written so well that your boss and coworkers will marvel at its beauty.">
    <meta name="twitter:image:src" content="http://localhost:4000/assets/images/fullsize/posts/making-python-code-beautiful/feat.jpg">

    <!-- Facebook OpenGraph -->
    <meta property="og:title"
          content="Making Python code beautiful – Thomas Breydo"/>
    <meta property="og:description"
          content="A bit of Python code can be written so well that your boss and coworkers will marvel at its beauty."/>
    <meta property="og:image" content="http://localhost:4000/assets/images/fullsize/posts/making-python-code-beautiful/feat.jpg"/>

    
        <!-- Font Embed Code -->
        <link rel="preload" href="https://fonts.googleapis.com/css?family=Merriweather:300,400|Muli:400,400i,600" as="style" onload="this.onload=null;this.rel='stylesheet'"> <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Merriweather:300,400|Muli:400,400i,600"></noscript>
    

    <!-- Styles -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/css/style.css">

    <!-- KaTeX -->
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.13.5/dist/katex.min.css" as="style"
          onload="this.onload=null;this.rel='stylesheet'"
          integrity="sha384-L+Gq2Cso/Y2x8fX4wausgiZT8z0QPZz7OqPuz4YqAycQJyrJT9NRLpjFBD6zlOia" crossorigin="anonymous">
    <noscript>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.5/dist/katex.min.css"
              integrity="sha384-L+Gq2Cso/Y2x8fX4wausgiZT8z0QPZz7OqPuz4YqAycQJyrJT9NRLpjFBD6zlOia"
              crossorigin="anonymous">
    </noscript>


    <!-- Icons -->
    <script defer src="https://use.fontawesome.com/releases/v5.1.1/js/solid.js"
            integrity="sha384-GXi56ipjsBwAe6v5X4xSrVNXGOmpdJYZEEh/0/GqJ3JTHsfDsF8v0YQvZCJYAiGu"
            crossorigin="anonymous"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.1.1/js/brands.js"
            integrity="sha384-0inRy4HkP0hJ038ZyfQ4vLl+F4POKbqnaUB6ewmU4dWP0ki8Q27A0VFiVRIpscvL"
            crossorigin="anonymous"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.1.1/js/fontawesome.js"
            integrity="sha384-NY6PHjYLP2f+gL3uaVfqUZImmw71ArL9+Roi9o+I4+RBqArA2CfW1sJ1wkABFfPe"
            crossorigin="anonymous"></script>

    
        <!-- Custom Styles -->
        <style></style>
    

    
        <!-- Analytics Code -->
        <!-- Global site tag (gtag.js) - Google Analytics --> <script async src="https://www.googletagmanager.com/gtag/js?id=G-6FT58MHFKF"></script> <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-6FT58MHFKF');
</script>
    

    
        <!-- Extra Header JS Code -->
        
    

    <!-- Extra Header -->
    

</head>


<body class="loading ajax-loading"
      data-site-url="http://localhost:4000" data-page-url="/blog/making-python-code-beautiful">


<header class="header">

    <div class="header-image header-image--on"
         style="background-image: url(/assets/images/fullsize/posts/making-python-code-beautiful/feat.jpg);"
         title="Making Python code beautiful – Thomas Breydo"></div>
    <div class="header-image"></div>

    <div class="header-overlay"></div>

    <div class="header__content">

        
            <a class="header__title" href="/">
                Hi, I'm Thomas
            </a>
        

        <p class="header__tagline">Software engineer and CS student at Stanford</p>

        <div class="menu">
            <div class="menu__toggle js-menu-toggle">
                <div class="menu__toggle__icon"><span></span></div>
            </div>
            <div class="menu__wrap">
                <ul class="menu__list">
                    
                        <li class="menu__list__item">
                            <a class="menu__list__item__link"
                               href="/">Latest</a>
                        </li>
                    
                        <li class="menu__list__item">
                            <a class="menu__list__item__link"
                               href="/about">About</a>
                        </li>
                    
                        <li class="menu__list__item">
                            <a class="menu__list__item__link"
                               href="/contact">Contact</a>
                        </li>
                    
                </ul>
                <ul class="socials">
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
            <li class="socials__item">
                <a href="https://tbreydo.medium.com" target="_blank" class="socials__item__link"
                   title="Medium">
                    <i class="fab fa-medium"
                       aria-hidden="true"></i>
                </a>
            </li>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
            <li class="socials__item">
                <a href="https://github.com/thomasbreydo" target="_blank" class="socials__item__link"
                   title="Github">
                    <i class="fab fa-github"
                       aria-hidden="true"></i>
                </a>
            </li>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
            <li class="socials__item">
                <a href="https://www.linkedin.com/in/thomas-nyc/" target="_blank" class="socials__item__link"
                   title="Linkedin">
                    <i class="fab fa-linkedin"
                       aria-hidden="true"></i>
                </a>
            </li>
        
    
</ul>
            </div>
        </div>

    </div>

</header>


<div class="loader">
    <svg width="120" height="30" viewBox="0 0 120 30" xmlns="http://www.w3.org/2000/svg">
        <circle cx="15" cy="15" r="15">
            <animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear"
                     repeatCount="indefinite"/>
            <animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1"
                     calcMode="linear" repeatCount="indefinite"/>
        </circle>
        <circle cx="60" cy="15" r="9" fill-opacity="0.3">
            <animate attributeName="r" from="9" to="9" begin="0s" dur="0.8s" values="9;15;9" calcMode="linear"
                     repeatCount="indefinite"/>
            <animate attributeName="fill-opacity" from="0.5" to="0.5" begin="0s" dur="0.8s" values=".5;1;.5"
                     calcMode="linear" repeatCount="indefinite"/>
        </circle>
        <circle cx="105" cy="15" r="15">
            <animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear"
                     repeatCount="indefinite"/>
            <animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1"
                     calcMode="linear" repeatCount="indefinite"/>
        </circle>
    </svg>
</div>

<div class="page-loader"></div>


<div class="page">

    <div class="page__content" data-page-title="Making Python code beautiful – Thomas Breydo"
         data-image="/assets/images/fullsize/posts/making-python-code-beautiful/feat.jpg">

        <section class="intro">

	<div class="wrap">

		<h1>Making Python code beautiful</h1>
		<p>04 October 2020</p>

	</div>

</section>

<section class="single">

	<div class="wrap">

		<p>A bit of Python code can be written so well that your boss and coworkers will marvel at its beauty. Keep reading to discover easy changes that will improve your code’s speed and style!</p>

<p>Treat this as a collection of useful concepts. Even you Python pros will find tips to apply to your code.</p>

<h3 id="tuple-unpacking">Tuple unpacking</h3>

<p>Let’s start simple. Say you wanted to swap the values that two variables store. In many languages (such as C), you would need to use a temporary variable, like this:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="n">originalB</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">originalB</span><span class="p">;</span>
</code></pre></div></div>

<p>But in Python, this is all shortened to just one readable line:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span>
</code></pre></div></div>

<p>That’s it! This is faster and more space-effective. Maybe your code is prettier already.</p>

<p><em>Python pros — did you know that you can use</em> <code class="language-plaintext highlighter-rouge">*</code> <em>to assign a list of values to a variable?</em></p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="o">*</span><span class="n">several</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>  <span class="c1"># 1
</span><span class="k">print</span><span class="p">(</span><span class="n">several</span><span class="p">)</span>  <span class="c1"># [3, 4, 5, 6, 7, 8]
</span></code></pre></div></div>

<h3 id="line-length">Line length</h3>

<p>Your lines should be at most 80–90 characters long. Use parentheses, not backslashes, to fix longer lines:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># BAD
</span><span class="n">long_variable_name</span> <span class="o">=</span> <span class="n">long_function_name</span><span class="p">(</span><span class="n">long_arg</span><span class="p">,</span> <span class="n">another_arg</span><span class="p">)</span> <span class="o">+</span> <span class="n">another_function</span><span class="p">()</span> <span class="o">-</span> <span class="n">final_function</span><span class="p">()</span> <span class="o">/</span> <span class="mi">3</span>

<span class="c1"># BETTER
</span><span class="n">long_variable_name</span> <span class="o">=</span> <span class="n">long_function_name</span><span class="p">(</span><span class="n">long_arg</span><span class="p">,</span> <span class="n">another_arg</span><span class="p">)</span> \
                        <span class="o">+</span> <span class="n">another_function</span><span class="p">()</span> <span class="o">-</span> <span class="n">final_function</span><span class="p">()</span> <span class="o">/</span> <span class="mi">3</span>

<span class="c1"># BEST!
</span><span class="n">long_variable_name</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">long_function_name</span><span class="p">(</span><span class="n">long_arg</span><span class="p">,</span> <span class="n">another_arg</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">another_function</span><span class="p">()</span>
    <span class="o">-</span> <span class="n">final_function</span><span class="p">()</span> <span class="o">/</span> <span class="mi">3</span>
<span class="p">)</span>
</code></pre></div></div>

<p>This leaves more whitespace and aligns the operators (e.g. <code class="language-plaintext highlighter-rouge">+</code> ), making it easier for somebody (including your future self) to understand the code.</p>

<p><em>Python pros — You can also look into linters, which automatically format your code for you! Linters go beyond line length: nested lists, spacing, etc. I use the</em> <a href="https://black.readthedocs.io/en/stable/"><em>Black</em></a> <em>linter and I love it.</em></p>

<h3 id="list-comprehension">List comprehension</h3>

<p>Here’s a quick one. I cringe whenever I see Python code that creates an empty list, then appends to it using a <code class="language-plaintext highlighter-rouge">for</code> loop:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">even_numbers</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">even_numbers</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</code></pre></div></div>

<p>If you ever catch yourself doing that, change it to this:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">even_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

<p>It’s faster and it’s a lot cleaner.</p>

<h3 id="context-managers">Context managers</h3>

<p><em>Please,</em> don’t read and write files without using <code class="language-plaintext highlighter-rouge">with</code>!</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">logfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'october.log'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
<span class="n">logfile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">'Bad code...</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>

<span class="c1"># BAD: logfile is never closed
</span></code></pre></div></div>

<p>First of all, file pointers are meant to be closed! Secondly, there’s a beautiful Python syntax that lets you forget the opening and closing:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'october.log'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">logfile</span><span class="p">:</span>
    <span class="n">logfile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">'Much better!</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>

<span class="c1"># GOOD: logfile is closed automatically
</span></code></pre></div></div>

<p><em>Python pros — You can actually write your own context managers. These are useful for code that has a setup and an ending action. The general structure looks like this:</em></p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">contextmanager</span>  <span class="c1"># standard library
</span>

<span class="o">@</span><span class="n">contextmanager</span>
<span class="k">def</span> <span class="nf">my_context_manager</span><span class="p">():</span>
    <span class="c1"># setup code: runs just before entering the
</span>    <span class="c1"># "with" statement
</span>    <span class="k">try</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">var</span>  <span class="c1"># or just "yield" if
</span>                   <span class="c1"># you don't need to pass
</span>                   <span class="c1"># a variable on
</span>    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># ending code: runs right after exiting the
</span>        <span class="c1"># "with" statement. It will run even if code
</span>        <span class="c1"># inside the "with" statement raised an exception!
</span></code></pre></div></div>

<p><em>Say you wanted to have a context manager that printed to let you know when your processes start and end:</em></p>

<p><em>That’s it! Now you can use it like this:</em></p>

<h3 id="positional-only-arguments">Positional-only arguments</h3>

<p>Often, the names of a function’s arguments are irrelevant. In this case, you want those arguments to always be passed positionally:</p>

<ul>
  <li>Positionally: <code class="language-plaintext highlighter-rouge">is_capitalized("world")</code></li>
  <li>Not positionally: <code class="language-plaintext highlighter-rouge">is_capitalized(string="world")</code></li>
</ul>

<p>In Python 3.8, you can force arguments to your functions to be positional! This can make code cleaner and more readable.</p>

<p>To achieve this functionality, use a <code class="language-plaintext highlighter-rouge">/</code> as an argument:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">is_capitalized</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="o">/</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">string</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">isupper</span><span class="p">()</span>
</code></pre></div></div>

<p>All arguments that precede the <code class="language-plaintext highlighter-rouge">/</code> will need to be passed positionally:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">is_capitalized</span><span class="p">(</span><span class="s">"October"</span><span class="p">)</span>
<span class="c1"># True
</span>
<span class="n">is_capitalized</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s">"October"</span><span class="p">)</span>
<span class="c1"># TypeError: is_capitalized() got some
# positional-only arguments passed as ...
</span></code></pre></div></div>

<h3 id="going-further">Going further</h3>

<p>There is a lot that you can do to make your code look neater. I encourage you to add your thoughts on the matter as a comment on this article.</p>

<p>If you want to look at tips from others, here are two good places to get started:</p>

<p>Raymond Hettinger’s <a href="https://www.youtube.com/watch?v=OSGv2VnC0go">PyCon 2013 talk</a> about idiomatic Python code. In it, he goes over many little changes you to your programs that make them nicer. The talk was part of the inspiration for this article. <em>Note, the talk shows code in Python 2. The top comment on the video explains the few changes you’ll need to make for Python 3.</em></p>

<p>Conor Hoekstra’s <a href="https://youtu.be/KTIl1MugsSY">PyCon 2020 talk</a> about refactoring Python code. In it, he shows how you can shrink a 60-line file to one-third the size. <em>Note, at</em> <a href="https://youtu.be/KTIl1MugsSY?t=891"><em>14:51</em></a> <em>in the video, Conor turns a try-except into an if-else. I discourage this, since it violates Python’s easier-to-ask-permission-than-forgiveness (EAFP) principle. Learn more about EAFP in</em> <a href="https://devblogs.microsoft.com/python/idiomatic-python-eafp-versus-lbyl/"><em>this</em></a> <em>article by Brett Cannon from Microsoft.</em></p>


	</div>

</section>

    </div>

</div>


<footer class="footer">

    <div class="footer__copyright">
        <span>© 2020-2024 Thomas Breydo</span>
    </div>

</footer>


<!-- Javascript Assets -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="/js/plugins-min.js"></script>
<script src="/js/journal-min.js"></script>


    <!-- Extra Footer JS Code -->
    



</body>

</html>